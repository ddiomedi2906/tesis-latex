\chapter{Results}
\label{cap5:results}
In this chapter we present the results obtained from the experiments proposed in the 
\textit{Experimental Design} chapter~\ref{cap4:experimentalDesign}. For each section, we 
display a table with the results 
along with a brief discussion for each case. All results are based on models trained on the 
training set of LC QuAD 2.

\section{Query Template generation}
\label{cap5:results/queryTemplate}
In Table~\ref{table:queryTemplateTraining} we can see the perplexity and BLEU score values after 
training the Convolutional Sequence to Sequence model (ConvS2S) for 40 epochs. Note that each 
epoch outputs a model checkpoint, and these results correspond to the best checkpoint in terms 
of the model with the lowest loss value over the validation set.

\begin{table}[h!]
    \centering
    \begin{tabular}{|c|cc|cc|}
        \hline
        \multirow{3}{*}{\textbf{System}} & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (train)}}       & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (valid)}}       \\ \cline{2-5} 
                                & \multicolumn{2}{c|}{\textbf{Size: 21,394}}            & \multicolumn{2}{c|}{\textbf{Size: 5,772}}             \\ \cline{2-5} 
                                & \multicolumn{1}{c|}{\textbf{Perplexity}} & \textbf{BLEU score} & \multicolumn{1}{c|}{\textbf{Perplexity}} & \textbf{BLEU score} \\ \hline
        ConvS2S                 & 1.17                            & 91.88      & 1.47                            & 73.42      \\ \hline
    \end{tabular}
    \caption{Perplexity and BLEU score after training the ConvS2S model.}
    \label{table:queryTemplateTraining}
\end{table}

Table~\ref{table:queryTemplateResults} shows the results of the Query Template task evaluated 
over the \LCQuADtwo{} validation dataset and the other two test datasets. We include the results of 
the Query Template generator which uses the trained ConvS2S model over \LCQuADtwo{} data. Aside 
from the evaluation over the best predicted query template, we also include an evaluation over 
the best prediction among the top 5 predictions. We consider the best prediction as the one with 
the highest BLEU score if compared with the expected answer. The baseline is the ConvS2S model 
trained over complete SPARQL queries (as done by Yin et al.~\cite{nmt:nl-to-sparql-Yin19}), but 
adding an extra layer that removes the entities from the output SPARQL queries, in a similar way 
as was done for generating the actual \LCQuADtwo{} Query Template dataset. The training results of 
the baseline are shown later in this chapter.

\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|cc|cc|cc|}
    \hline
    \multirow{3}{*}{\textbf{System}} & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (valid)}}          & \multicolumn{2}{c|}{\textbf{QALD-7}}                     & \multicolumn{2}{c|}{\textbf{WikiSPARQL}}                 \\ \cline{2-7} 
                            & \multicolumn{2}{c|}{\textbf{Size: 21,394}}               & \multicolumn{2}{c|}{\textbf{Size: 5,772}}                & \multicolumn{2}{c|}{\textbf{Size: 100}]}                  \\ \cline{2-7} 
                            & \multicolumn{1}{c|}{\textbf{BLEU score}} & \textbf{Accuracy (\%)} & \multicolumn{1}{c|}{\textbf{BLEU score}} & \textbf{Accuracy (\%)} & \multicolumn{1}{c|}{\textbf{BLEU score}} & \textbf{Accuracy (\%)} \\ \hline
    QTG - Top 1             & 65.18                           & 34.27         & 20.29                           & 0             & 20.12                           & 0             \\
    QTG - Top 5             & 76.86                           & 49.53         & 22.58                           & 0.67          & 23.1                            & 0             \\ \hline
    Baseline                & 63.06                           & 29.82         & 19.72                           & 0.67          & 20.31                           & 0             \\ \hline
    \end{tabular}%
    }
    \caption{BLEU score and accuracy for the Query Template generation task.}
    \label{table:queryTemplateResults}
\end{table}

According to the results of Tables \ref{table:queryTemplateTraining} and \ref{table:queryTemplateResults}, 
we see that the Query Template generation has a better performance than the Baseline in both 
BLEU score and accuracy. If we look at the best 5 for the \LCQuADtwo{} validation dataset, we find 
there are better results. On the other hand, we see that the models trained on the \LCQuADtwo{} 
training set do not generalize well to other datasets.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|c|cc|cc|c|}
    \hline
    \multicolumn{7}{|c|}{\textbf{Performance analysis per template (QT generator vs Baseline) - LC-QuAD 2 valid}}                                                                                                                                                                                                                                                                                                                                                                                                                             \\ \hline
    \multirow{2}{*}{\textbf{ID}} & \multirow{2}{*}{\textbf{Template type}}                                                                                & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{Size}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}\% \\ Dataset\end{tabular}}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}QTG \\ Accuracy\end{tabular}}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Baseline \\ Accuracy\end{tabular}}} & \multirow{2}{*}{\textbf{Diff Accuracy}} \\
                                 &                                                                                                                        & \multicolumn{1}{c|}{}                               &                                                                                 & \multicolumn{1}{c|}{}                                                                                  &                                                                                        &                                         \\ \hline
    1                            & ask\_one\_fact                                                                                                         & 112                                                 & 1.94\%                                                                          & 51.79\%                                                                                                & 17.86\%                                                                                & 33.93\%                                 \\ \hline
    2                            & ask\_one\_fact\_with\_filter                                                                                           & 362                                                 & 6.27\%                                                                          & 45.03\%                                                                                                & 42.82\%                                                                                & 2.21\%                                  \\ \hline
    3                            & ask\_two\_facts                                                                                                        & 113                                                 & 1.96\%                                                                          & 30.97\%                                                                                                & 7.96\%                                                                                 & 23.01\%                                 \\ \hline
    4                            & count\_one\_fact\_object                                                                                               & 126                                                 & 2.18\%                                                                          & 25.40\%                                                                                                & 23.02\%                                                                                & 2.38\%                                  \\ \hline
    5                            & count\_one\_fact\_subject                                                                                              & 182                                                 & 3.15\%                                                                          & 9.89\%                                                                                                 & 3.85\%                                                                                 & 6.04\%                                  \\ \hline
    6                            & rank\_instance\_of\_type\_one\_fact                                                                                    & 78                                                  & 1.35\%                                                                          & 32.05\%                                                                                                & 34.62\%                                                                                & \textbf{-2.57\%}                        \\ \hline
    7                            & rank\_max\_instance\_of\_type\_two\_facts                                                                              & 68                                                  & 1.18\%                                                                          & 7.35\%                                                                                                 & 7.35\%                                                                                 & 0.00\%                                  \\ \hline
    8                            & rank\_min\_instance\_of\_type\_two\_facts                                                                              & 70                                                  & 1.21\%                                                                          & 14.29\%                                                                                                & 8.57\%                                                                                 & 5.72\%                                  \\ \hline
    9                            & select\_object\_instance\_of\_type                                                                                     & 392                                                 & 6.79\%                                                                          & 23.72\%                                                                                                & 23.47\%                                                                                & 0.25\%                                  \\ \hline
    10                           & select\_object\_using\_one\_statement\_property                                                                        & 583                                                 & 10.10\%                                                                         & 50.94\%                                                                                                & 40.82\%                                                                                & 10.12\%                                 \\ \hline
    11                           & select\_one\_fact\_object                                                                                              & 78                                                  & 1.35\%                                                                          & 7.69\%                                                                                                 & 10.26\%                                                                                & \textbf{-2.57\%}                        \\ \hline
    12                           & select\_one\_fact\_subject                                                                                             & 288                                                 & 4.99\%                                                                          & 5.90\%                                                                                                 & 9.72\%                                                                                 & \textbf{-3.82\%}                        \\ \hline
    13                           & \begin{tabular}[c]{@{}c@{}}select\_one\_qualifier\_value\_and\_object\_using\\ \_one\_statement\_property\end{tabular} & 136                                                 & 2.36\%                                                                          & 52.94\%                                                                                                & 48.53\%                                                                                & 4.41\%                                  \\ \hline
    14                           & \begin{tabular}[c]{@{}c@{}}select\_one\_qualifier\_value\_using\_one\\ \_statement\_property\end{tabular}              & 631                                                 & 10.93\%                                                                         & 52.14\%                                                                                                & 39.78\%                                                                                & 12.36\%                                 \\ \hline
    15                           & select\_subject\_instance\_of\_type                                                                                    & 424                                                 & 7.35\%                                                                          & 25.00\%                                                                                                & 20.75\%                                                                                & 4.25\%                                  \\ \hline
    16                           & select\_subject\_instance\_of\_type\_contains\_word                                                                    & 286                                                 & 4.95\%                                                                          & 70.98\%                                                                                                & 61.19\%                                                                                & 9.79\%                                  \\ \hline
    17                           & select\_subject\_instance\_of\_type\_starts\_with                                                                      & 285                                                 & 4.94\%                                                                          & 77.54\%                                                                                                & 74.04\%                                                                                & 3.50\%                                  \\ \hline
    18                           & select\_two\_answers                                                                                                   & 191                                                 & 3.31\%                                                                          & 16.23\%                                                                                                & 9.95\%                                                                                 & 6.28\%                                  \\ \hline
    19                           & select\_two\_facts\_left\_subject                                                                                      & 393                                                 & 6.81\%                                                                          & 13.23\%                                                                                                & 12.98\%                                                                                & 0.25\%                                  \\ \hline
    20                           & select\_two\_facts\_right\_subject                                                                                     & 412                                                 & 7.14\%                                                                          & 14.08\%                                                                                                & 17.72\%                                                                                & \textbf{-3.64\%}                        \\ \hline
    21                           & select\_two\_facts\_subject\_object                                                                                    & 389                                                 & 6.74\%                                                                          & 31.88\%                                                                                                & 31.11\%                                                                                & 0.77\%                                  \\ \hline
    22                           & \begin{tabular}[c]{@{}c@{}}select\_two\_qualifier\_values\_using\_one\\ \_statement\_property\end{tabular}             & 173                                                 & 3.00\%                                                                          & 26.59\%                                                                                                & 24.28\%                                                                                & 2.31\%                                  \\ \hline
    \multicolumn{2}{|c|}{Total}                                                                                                                           & 5772                                                & 100\%                                                                           & 34.67\%                                                                                                & 29.82\%                                                                                & 4.85\%                                  \\ \hline
    \end{tabular}%
    }
    \caption{Performance comparison per template between Query Template generator and Baseline.}
    \label{table:queryTemplatePerTemplate}
\end{table}

Finally, we present in Table 3 a more granular comparison between our proposed Query Template 
generator and the baseline by dividing the results into the 22 base templates used for generating 
the \LCQuADtwo{} dataset (more details on each base template can be found in 
Appendix~\ref{appendix:qaDataset}). We note that, even though our Query Template generator 
performs better in many cases, there are some others where the Baseline performs better. A 
possible explanation for this difference is that the Baseline still maintains an advantage in 
terms of the amount of information it keeps in the entities used in training versus the 
placeholders used to replace those entities for generating the training data for our Query 
Template generator. Then, while the Baseline can identify more effective entity categories (e.g. 
people, locations, organizations), the placeholder only can maintain information about entity 
location in the query (to which query pattern it belongs) or entity type (subject or object). 

In summary, we see that the same ConvS2S model can perform as well or better for the task of 
generating Query Templates as it does for SPARQL query generation, obtaining scores of BLEU and 
accuracy equal or greater than the ones obtained from the baseline. On the other side, we still 
identified a certain degree of overfitting in the model (similar to the results obtained by 
Yin et al.~\cite{nmt:nl-to-sparql-Yin19}), thus not being able to perform well on the proposed 
test datasets (\QALDseven{} and \WikiSPARQL{}). However, we think the metric used for measuring 
performance here (BLEU score and accuracy) do not quantify the equivalences between query 
templates properly. For example, queries in the test data could have a different ordering in 
their query triples than the generator uses to build query templates.

\section{Entity Linking}
\label{cap5:results/entityLinking}
First, we calculate the performance of each Individual Entity Linking (IEL) system over the 
validation \LCQuADtwo{} dataset. These results were used to determine the priority each IEL system 
will have when being used by the Ensemble Entity Linking (EEL) systems. As mentioned before, the 
priority of each IEL system is determined by their precision results where more precise systems 
have higher priority. Therefore, according to the results in Table~\ref{table:ielResultsLcquad2}, 
the priority used is the following: AIDA, OpenTapioca, TAGME, and DBpedia Spotlight.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|ccc|ccc|}
    \hline
    \multicolumn{7}{|c|}{\textbf{LCQUAD2 (valid): 5772 questions}}                                                                                                                                                                             \\ \hline
    \multirow{2}{*}{\textbf{System}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                & \multicolumn{3}{c|}{\textbf{Macro}}                                                                \\ \cline{2-7} 
                                     & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} \\ \hline
    AIDA                             & 31.3                                 & 72.5                                    & 43.7              & 30.5                                 & 38.5                                    & 33.1              \\
    OpenTapioca                      & 32.0                                 & 61.8                                    & 42.2              & 30.2                                 & 34.9                                    & 31.4              \\
    TAGME                            & 59.5                                 & 25.0                                    & 35.2              & 59.4                                 & 29.5                                    & 37.4              \\
    DBpedia Spotlight                & 52.7                                 & 20.8                                    & 29.9              & 52.5                                 & 23.3                                    & 30.8              \\ \hline
    \end{tabular}%
    }
    \caption{Performance of the Individual Entity Linking systems over \LCQuADtwo{} validation.}
    \label{table:ielResultsLcquad2}
    \end{table}

Next, we tested the two EEL systems proposed in this work: the Precision Priority (PPrior) system 
and the Voting system. For each EEL system we tried different heuristics proposed to improve 
performance: vary the number of entities in the output, filter stopwords, or apply tiebreak using 
IEL system scores. In the case of varying the number of entities, we tried including all entities, 
reducing output size to either a fixed value\footnote{Since most SPARQL queries included in our 
datasets have at most three entities, we set that value as the fixed size. } or a variable amount 
defined by the number of placeholders contained in the query template for each case. 

The baseline (Oracle system) combines all the results of the IEL systems and evaluates what is 
the best performance an EEL system could achieve if it could “guess” the correct entities among 
the IEL system answers in each case; in other words, the baseline indicates the best possible 
result given the results of the IEL systems. 

Various variants for both EEL systems are shown in Table~\ref{table:eelResultsLcquad2}, where we 
tried different combinations of the proposed heuristics. Here we evaluate the results over the 
\LCQuADtwo{} validation dataset, resulting in the Voting system having a slight better performance 
for most variations. 

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|ccc|ccc|ccc|}
    \hline
    \multicolumn{10}{|c|}{\textbf{LCQUAD2 (valid): 5772 questions}}                                                                                                                                                                                                                                                                                                                                                                                                                                    \\ \hline
    \multirow{2}{*}{\textbf{System}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Output\\ size\end{tabular}}}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Stopwords\\ filter\end{tabular}}}} & \multirow{2}{*}{\textbf{Tiebreak}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                & \multicolumn{3}{c|}{\textbf{Macro}}                                                                \\ \cline{5-10} 
                                     & \multicolumn{1}{c|}{}                                                                                & \multicolumn{1}{c|}{}                                                                                     &                                    & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} \\ \hline
    Precision prior                  & All                                                                                                  & True                                                                                                      & --                                 & 68.6                                 & 19.5                                    & 30.3              & 68.4                                 & 23.9                                    & 33.6              \\
    Precision prior                  & 3                                                                                                    & True                                                                                                      & True                               & 63.8                                 & 32.1                                    & 42.7              & 64.1                                 & 32.7                                    & 41.9              \\
    Precision prior                  & +                                                                                                    & False                                                                                                     & False                              & 58.2                                 & 33.8                                    & 42.8              & 57.6                                 & 44.4                                    & 48.2              \\
    Precision prior                  & +                                                                                                    & True                                                                                                      & False                              & 59.3                                 & 34.8                                    & 43.9              & 58.8                                 & 45.6                                    & 49.3              \\
    Precision prior                  & +                                                                                                    & True                                                                                                      & True                               & 55.1                                 & 55.3                                    & 55.2              & 54.4                                 & 54.4                                    & 54.4              \\ \hline
    \textbf{Voting system}           & \textbf{All}                                                                                         & \textbf{True}                                                                                             & \textbf{--}                        & \textbf{68.6}                        & \textbf{19.5}                           & \textbf{30.3}     & \textbf{68.4}                        & \textbf{23.9}                           & \textbf{33.6}     \\
    Voting system                    & 3                                                                                                    & True                                                                                                      & True                               & 63.7                                 & 32.1                                    & 42.7              & 64                                   & 32.7                                    & 41.9              \\
    Voting system                    & +                                                                                                    & False                                                                                                     & False                              & 57.6                                 & 43.7                                    & 49.7              & 57                                   & 50.4                                    & 52.5              \\
    Voting system                    & +                                                                                                    & True                                                                                                      & False                              & 58.3                                 & 44.5                                    & 50.5              & 57.7                                 & 51.1                                    & 53.2              \\
    \textbf{Voting system}           & \textbf{+}                                                                                           & \textbf{True}                                                                                             & \textbf{True}                      & \textbf{56.2}                        & \textbf{56.4}                           & \textbf{56.3}     & \textbf{55.4}                        & \textbf{55.4}                           & \textbf{55.4}     \\ \hline
    \multicolumn{4}{|c|}{Baseline: Oracle system}                                                                                                                                                                                                                                            & 68.6                                 & 70.4                                    & 69.5              & 68.4                                 & 68.4                                    & 68.4              \\ \hline
    \end{tabular}%
    }
    \caption{Results of the Ensemble Entity Linking systems over \LCQuADtwo{} validation.}
    \label{table:eelResultsLcquad2}
\end{table}

Note that when including all entities the results of the PPrior system and Voting system are 
identical, though the ranking scores assigned to each entity might differ. Furthermore, the 
variants that include all entities in the output results reach a better recall, which is 
consistent with these variants including more entities that are potentially part of the expected 
answers.

The effect of decreasing the amount of entities returned for each case is a trade-off between 
recall and precision: while the recall tends to decrease, we note a major increase in precision. 
While the case with a fixed number of three maintains most of the correct answers without 
degrading precision much, the case where the number varies (denoted as “+” in Table~\ref{table:eelResultsLcquad2}) 
presents the worst performance but the best precision. The filter of stopwords helped a small 
amount in both recall and precision, whereas the use of tiebreak greatly benefits precision 
while slightly degrading recall.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|ccc|ccc|}
    \hline
    \multicolumn{7}{|c|}{\textbf{QALD 7: 150 questions}}                                                                                                                                                                                       \\ \hline
    \multirow{2}{*}{\textbf{System}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                & \multicolumn{3}{c|}{\textbf{Macro}}                                                                \\ \cline{2-7} 
                                     & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} \\ \hline
    AIDA                             & 41.2                                 & 79.1                                    & 54.2              & 43.7                                 & 54.0                                    & 47.1              \\
    OpenTapioca                      & 33.2                                 & 60.3                                    & 42.8              & 34.2                                 & 38.9                                    & 34.2              \\
    TAGME                            & 58.3                                 & 31.5                                    & 40.9              & 62.0                                 & 36.0                                    & 43.1              \\
    DBpedia Spotlight                & 62.6                                 & 31.4                                    & 41.8              & 65.7                                 & 32.3                                    & 41.1              \\ \hline
    Precision Prior (All)            & 74.4                                 & 27.7                                    & 40.4              & 76.6                                 & 32.5                                    & 43.6              \\
    Precision Prior (3)              & 69.7                                 & 35.5                                    & 47.0              & 72.2                                 & 37.3                                    & 47.5              \\
    Precision Prior (+)              & 58.8                                 & 59.0                                    & 58.9              & 60.6                                 & 60.6                                    & 60.6              \\ \hline
    \textbf{Voting system (All)}     & \textbf{74.4}                        & \textbf{27.7}                           & \textbf{40.4}     & \textbf{76.6}                        & \textbf{32.5}                           & \textbf{43.6}     \\
    Voting system (3)                & 68.7                                 & 35.0                                    & 46.4              & 71.3                                 & 36.9                                    & 47.0              \\
    \textbf{Voting system (+)}       & \textbf{61.1}                        & \textbf{61.4}                           & \textbf{61.3}     & \textbf{63.0}                        & \textbf{63.0}                           & \textbf{63.0}     \\ \hline
    Oracle system                    & 74.4                                 & 76.2                                    & 75.3              & 76.6                                 & 76.8                                    & 76.6              \\ \hline
    \end{tabular}%
    }
    \caption{ Results of the Entity Linking systems over \QALDseven{} (train+test).}
    \label{table:elResultsQald7}
\end{table}

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|l|rrr|rrr|}
    \hline
    \multicolumn{7}{|c|}{\textbf{WikiSPARQL: 100 questions}}                                                                                                                                                                                                                                                   \\ \hline
    \multicolumn{1}{|c|}{\multirow{2}{*}{\textbf{System}}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                                     & \multicolumn{3}{c|}{\textbf{Macro}}                                                                                     \\ \cline{2-7} 
    \multicolumn{1}{|c|}{}                                 & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \multicolumn{1}{c|}{\textbf{F1-score}} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \multicolumn{1}{c|}{\textbf{F1-score}} \\ \hline
    AIDA                                                   & 23.3                                 & 75.4                                    & 35.5                                   & 27.3                                 & 34.2                                    & 29.5                                   \\
    OpenTapioca                                            & 14.0                                 & 51.2                                    & 22.0                                   & 18.8                                 & 20.6                                    & 18.9                                   \\
    TAGME                                                  & 60.7                                 & 37.0                                    & 46.0                                   & 59.3                                 & 40.3                                    & 45.5                                   \\
    DBpedia Spotlight                                      & 60.0                                 & 34.9                                    & 44.1                                   & 57.5                                 & 38.9                                    & 43.1                                   \\ \hline
    Precision Prior (All)                                  & 75.3                                 & 32.7                                    & 45.6                                   & 72.5                                 & 38.4                                    & 47.6                                   \\
    Precision Prior (3)                                    & 69.3                                 & 38.0                                    & 49.1                                   & 67.3                                 & 41.4                                    & 49.0                                   \\
    Precision Prior (+)                                    & 52.7                                 & 49.4                                    & 51.0                                   & 51.2                                 & 52.2                                    & 51.6                                   \\ \hline
    \textbf{Voting system (All)}                           & \textbf{75.3}                        & \textbf{32.7}                           & \textbf{45.6}                          & \textbf{72.5}                        & \textbf{38.4}                           & \textbf{47.6}                          \\
    Voting system (3)                                      & 70.7                                 & 38.7                                    & 50.0                                   & 68.1                                 & 42.1                                    & 49.7                                   \\
    \textbf{Voting system (+)}                             & \textbf{56.7}                        & \textbf{53.1}                           & \textbf{54.8}                          & \textbf{53.2}                        & \textbf{54.2}                           & \textbf{53.5}                          \\ \hline
    Oracle system                                          & 75.3                                 & 76.4                                    & 75.8                                   & 76.5                                 & 76.7                                    & 76.6                                   \\ \hline
    \end{tabular}%
    }
    \caption{Results of the Entity Linking systems over our proposed \WikiSPARQL{} dataset.}
    \label{table:elResultsWikiSparql}
\end{table}

Finally, we evaluate both IEL systems and EEL systems over the test datasets: \QALDseven{}, and our 
proposed \WikiSPARQL{} dataset. For each EEL system we include the three variants in output size
used for Table~\ref{table:eelResultsLcquad2}. Tables~\ref{table:elResultsQald7} and \ref{table:elResultsWikiSparql} 
display the result for the \QALDseven{}, and \WikiSPARQL{}, respectively.

From the results of Tables ~\ref{table:elResultsQald7} and \ref{table:elResultsWikiSparql} we can 
see that overall the Voting system is the system with the best F1 score. The EEL system variants 
with the highest recall and precision maintain that tendency over all datasets. In this case, it 
seems that the systems with variable outpur size fall behind compared to the oracle, where the 
best performing system is around 0.15 to 0.2 points behind the oracle results in terms of F1-score. 

\section{Sequence Labeling and Slot Filling}
\label{cap5:results/seqLabSlotFilling}

The performance results of the Flair Sequence Tagger are shown in Table~\ref{table:seqLabFlairResults}. 
In this case, the Precision and Recall are measured with respect to the pairs \texttt{<slot, label>}, 
where the slot is a placeholder of Query Template and the label is a substring of a natural 
language question.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|c|ccc|ccc|}
    \hline
    \multirow{2}{*}{\textbf{Dataset}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Number \\ of cases\end{tabular}}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                         & \multicolumn{3}{c|}{\textbf{Macro}}                                                                         \\ \cline{3-8} 
                                      &                                                                                      & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} \\ \hline
    LC-QuAD 2 (valid)               & 5772                                                                                 & 66.9                                 & 62.0                                    & 64.4              & 66.9                                 & 63.8                                    & 64.8              \\
    QALD-7                            & 150                                                                                  & 43.6                                 & 37.0                                    & 40.0              & 45.3                                 & 45.4                                    & 44.8              \\
    WikiSPARQL                        & 100                                                                                  & 29.8                                 & 22.7                                    & 25.8              & 31.8                                 & 30.9                                    & 31.0              \\ \hline
    \end{tabular}%
    }
    \caption{Results of the Flair Sequence Tagger.}
    \label{table:seqLabFlairResults}
\end{table}

Next, we measure how the proposed filling method performs. In this case, the precision and recall 
are measured with respect to the pairs \texttt{<slot, entity>}, where the slot remains the same 
and the entity corresponds to the ones contained in a SPARQL query. We test the standard filling 
method, and the force filling method we proposed to address the Sequence Tagger errors. These 
results are shown in Table~\ref{table:standardSlotFillingResults} and \ref{table:forceSlotFillingResults}, 
respectively. Note that we are using the entity linking results corresponding to the Voting system 
returning all entities in the output. We chose to return all entities to see how each filling
method performs when there are incorrect entitites. Also, we use the Voting system given that
presents better performance than the PPrior system according to the results shown in the 
\textit{Entity Linking} section~\ref{cap5:results/entityLinking}, as well as for the results shown 
below in the \textit{SPARQL Query generation} section~\ref{cap5:results/sparqlQuery}.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|c|ccc|ccc|}
    \hline
    \multirow{2}{*}{\textbf{Dataset}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Number \\ of cases\end{tabular}}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                         & \multicolumn{3}{c|}{\textbf{Macro}}                                                                         \\ \cline{3-8} 
                                      &                                                                                      & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} \\ \hline
    LC-QuAD 2 (valid)               & 5772                                                                                 & 45.7                                 & 61.4                                    & 52.4              & 46.7                                 & 54.2                                    & 49.2              \\
    QALD-7                            & 150                                                                                  & 27.9                                 & 52.6                                    & 36.4              & 35.2                                 & 39.0                                    & 36.3              \\
    WikiSPARQL                        & 100                                                                                  & 13.2                                 & 26.3                                    & 17.6              & 19.8                                 & 22.3                                    & 20.5              \\ \hline
    \end{tabular}%
    }
    \caption{Results of the Slot Filling system using the standard filling method.}
    \label{table:standardSlotFillingResults}
\end{table}

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|c|ccc|ccc|}
    \hline
    \multirow{2}{*}{\textbf{Dataset}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Number \\ of cases\end{tabular}}} & \multicolumn{3}{c|}{\textbf{Micro}}                                                                         & \multicolumn{3}{c|}{\textbf{Macro}}                                                                         \\ \cline{3-8} 
                                      &                                                                                      & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1-score} \\ \hline
    LC-QuAD 2 (valid)               & 5772                                                                                 & 49.2                                 & 51.0                                    & 50.1              & 50.3                                 & 52.7                                    & 50.5              \\
    QALD-7                            & 150                                                                                  & 39.2                                 & 31.3                                    & 32.1              & 40.8                                 & 34.0                                    & 35.9              \\
    WikiSPARQL                        & 100                                                                                  & 17.0                                 & 16.5                                    & 16.7              & 20.6                                 & 16.8                                    & 17.7              \\ \hline
    \end{tabular}%
    }
    \caption{Results of the Slot Filling system using the force filling method.}
    \label{table:forceSlotFillingResults}
\end{table}

The number of correct cases for both slot filling methods is lower than the correct labeled cases 
of the Sequence Tagger. This is expected since many incorrect cases might occur due to the errors 
given by the Entity Linking system. On the other hand, the standard filling method shows more 
precision while the force filling method brings more recall. This is also expected since the force 
filling method adds more labels that might bring more correct answers, along with more incorrect 
ones. As opposed to the case for Entity Linking systems, we prefer a filling method with higher 
recall in order to generate more valid SPARQL queries.

\section{SPARQL Query Generation}
\label{cap5:results/sparqlQuery}

The training results for the Baseline of the SPARQL Query generation task are shown in 
Table~\ref{table:queryGenerationTraining}. We note similar results as the ones obtained in 
Yin et al~\cite{nmt:nl-to-sparql-Yin19}, where there is notable overfitting for the training data.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \begin{tabular}{|c|cc|cc|}
    \hline
    \multirow{3}{*}{\textbf{System}} & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (train)}}                         & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (valid)}}                         \\ \cline{2-5} 
                                     & \multicolumn{2}{c|}{\textbf{Size: 21934}}                               & \multicolumn{2}{c|}{\textbf{Size: 5772}}                                \\ \cline{2-5} 
                                     & \multicolumn{1}{c|}{\textbf{Perplexity}} & \textbf{BLEU score} & \multicolumn{1}{c|}{\textbf{Perplexity}} & \textbf{BLEU score} \\ \hline
    Baseline                         & 1.19                                     & 98.35               & 3.2                                      & 60.39               \\ \hline
    \end{tabular}%
    \caption{Perplexity and BLEU score after training the SPARQL Query Generator baseline.}
    \label{table:queryGenerationTraining}
\end{table}

Next, the results of the Entity Linking Neural Question Answering (ElNeuQA) system proposed in 
this work are displayed in Table~\ref{table:queryGenerationResults}. In this case, we try four 
different variants where we chose the best variant of both PPrior and Voting systems and both 
slot filling methods. These variations are tested over the \LCQuADtwo{} validation dataset. We also 
output results picking best among the top 5 predicted results per case over both variants that 
utilized the Force filling method. In this context, the criteria to select the best results is 
the answer with the highest BLEU score when comparing to the expected answer.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \begin{tabular}{|c|cc|cc|}
    \hline
    \multirow{3}{*}{\textbf{System}} & \multicolumn{1}{c|}{\multirow{3}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Entity Linking \\ system\end{tabular}}}} & \multirow{3}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Filling \\ method\end{tabular}}} & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (valid)}}                   \\ \cline{4-5} 
                                     & \multicolumn{1}{c|}{}                                                                                           &                                                                                     & \multicolumn{2}{c|}{\textbf{Size: 5772}}                          \\ \cline{4-5} 
                                     & \multicolumn{1}{c|}{}                                                                                           &                                                                                     & \multicolumn{1}{c|}{\textbf{BLEU score}} & \textbf{Accuracy (\%)} \\ \hline
    ElNeuQA                          & PPrior (All)                                                                                                    & Standard                                                                            & 58.01                                    & 11.83                  \\
    ElNeuQA                          & PPrior (+)                                                                                                      & Standard                                                                            & 57.36                                    & 10.41                  \\
    ElNeuQA                          & Voting (All)                                                                                                    & Standard                                                                            & 58.47                                    & 12.72                  \\
    ElNeuQA                          & Voting (+)                                                                                                      & Standard                                                                            & 57.6                                     & 10.88                  \\ \hline
    ElNeuQA                          & PPrior (All)                                                                                                    & Force                                                                               & 59.16                                    & 13.7                   \\
    ElNeuQA                          & PPrior (+)                                                                                                      & Force                                                                               & 57.95                                    & 10.9                   \\
    \textbf{ElNeuQA}                 & \textbf{Voting (All)}                                                                                           & \textbf{Force}                                                                      & \textbf{59.34}                           & \textbf{13.96}         \\
    ElNeuQA                          & Voting (+)                                                                                                      & Force                                                                               & 58.13                                    & 11.31                  \\ \hline
    ElNeuQA - Top 5                  & PPrior (All)                                                                                                    & Force                                                                               & 68.16                                    & 20.32                  \\
    ElNeuQA - Top 5                  & Voting (All)                                                                                                    & Force                                                                               & 68.43                                    & 20.7                   \\ \hline
    \multicolumn{3}{|c|}{Baseline}                                                                                                                                                                                                           & 51.5                                     & 3.27                   \\ \hline
    \end{tabular}%
    \caption{Comparison of performance for the SPARQL query generator when varying the EEL system and filling method.}
    \label{table:queryGenerationResults}
\end{table}

The results obtained for \LCQuADtwo{} do not transfer to the other test datasets. As seen in 
Table~\ref{table:queryGenerationTestResults}, our system is not capable of generalizing the results 
obtained from training over other types of datasets given that the type of queries contained in 
test datasets are not based on template generation, thus making it difficult to generate an exact 
match. We may also be generating equivalent SPARQL queries (i.e. that return the same answers if 
executed), and the way we are evaluating these results does not consider SPARQL query equivalences.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \begin{tabular}{|c|cc|cc|cc|}
    \hline
    \multirow{3}{*}{\textbf{System}} & \multicolumn{2}{c|}{\textbf{LC-QuAD 2 (valid)}}                                                                                                         & \multicolumn{2}{c|}{\textbf{QALD-7}}                                                                                                                    & \multicolumn{2}{c|}{\textbf{WikiSPARQL}}                                                                                                                \\ \cline{2-7} 
                                     & \multicolumn{2}{c|}{\textbf{Size: 5772}}                                                                                                                & \multicolumn{2}{c|}{\textbf{Size: 150}}                                                                                                                 & \multicolumn{2}{c|}{\textbf{Size: 100}}                                                                                                                 \\ \cline{2-7} 
                                     & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}BLEU \\ score\end{tabular}}} & \textbf{\begin{tabular}[c]{@{}c@{}}Accuracy \\ (\%)\end{tabular}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}BLEU \\ score\end{tabular}}} & \textbf{\begin{tabular}[c]{@{}c@{}}Accuracy \\ (\%)\end{tabular}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}BLEU \\ score\end{tabular}}} & \textbf{\begin{tabular}[c]{@{}c@{}}Accuracy \\ (\%)\end{tabular}} \\ \hline
    ElNeuQA - Top 1                  & 59.34                                                                               & 13.96                                                             & 20.14                                                                               & 0                                                                 & 20.48                                                                               & 0                                                                 \\
    ElNeuQA - Top 5                  & 68.43                                                                               & 20.7                                                              & 21.99                                                                               & 0                                                                 & 22.15                                                                               & 0                                                                 \\ \hline
    Baseline                         & 51.5                                                                                & 3.27                                                              & 19.09                                                                               & 0                                                                 & 18.8                                                                                & 0                                                                 \\ \hline
    \end{tabular}%
    \caption{BLEU score and accuracy for the SPARQL Query generation task.}
    \label{table:queryGenerationTestResults}
\end{table}

The same analysis per template performed over the Query Template generation task are done for the 
SPARQL query generation task. In Table~\ref{table:queryGenerationComparison} the results in terms 
of accuracy are displayed for each \LCQuADtwo{} base template. We see that there are more cases than 
before where our proposed system performed better than the Baseline, especially due to the 
inability of the latter system to generate a single valid query for some templates. Among those 
cases, the ask one fact template is the most noticeable case since it should be the simplest one. 
The main reason for these cases to occur is that the Baseline system fails to identify the 
relevant entities due to not having seen them during training time. As we will discuss later, the 
vocabulary dependence of the Baseline plays a major role in the worse performance of this system. 

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|l|c|cc|cc|c|}
    \hline
    \multicolumn{7}{|c|}{\textbf{Performance analysis per template (ElNeuQA vs Baseline) - LC-QuAD 2 valid}}                                                                                                                                                                                                                                                                                                                                                                                                                                      \\ \hline
    \multirow{2}{*}{\textbf{ID}} & \multirow{2}{*}{\textbf{Template type}}                                                                                & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{Size}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}\% \\ Dataset\end{tabular}}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}ElNeuQA \\ Accuracy\end{tabular}}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Baseline \\ Accuracy\end{tabular}}} & \multirow{2}{*}{\textbf{Diff Accuracy}} \\
                                 &                                                                                                                        & \multicolumn{1}{c|}{}                               &                                                                                 & \multicolumn{1}{c|}{}                                                                                      &                                                                                        &                                         \\ \hline
    1                            & ask\_one\_fact                                                                                                         & 112                                                 & 1.94\%                                                                          & 36.61\%                                                                                                    & 0.00\%                                                                                 & 36.61\%                                 \\ \hline
    2                            & ask\_one\_fact\_with\_filter                                                                                           & 362                                                 & 6.27\%                                                                          & 20.44\%                                                                                                    & 0.83\%                                                                                 & 19.61\%                                 \\ \hline
    3                            & ask\_two\_facts                                                                                                        & 113                                                 & 1.96\%                                                                          & 15.93\%                                                                                                    & 0.00\%                                                                                 & 15.93\%                                 \\ \hline
    4                            & count\_one\_fact\_object                                                                                               & 126                                                 & 2.18\%                                                                          & 20.63\%                                                                                                    & 8.73\%                                                                                 & 11.90\%                                 \\ \hline
    5                            & count\_one\_fact\_subject                                                                                              & 182                                                 & 3.15\%                                                                          & 9.34\%                                                                                                     & 0.55\%                                                                                 & 8.79\%                                  \\ \hline
    6                            & rank\_instance\_of\_type\_one\_fact                                                                                    & 78                                                  & 1.35\%                                                                          & 11.54\%                                                                                                    & 17.95\%                                                                                & \textbf{-6.41\%}                        \\ \hline
    7                            & rank\_max\_instance\_of\_type\_two\_facts                                                                              & 68                                                  & 1.18\%                                                                          & 0.00\%                                                                                                     & 1.47\%                                                                                 & \textbf{-1.47\%}                        \\ \hline
    8                            & rank\_min\_instance\_of\_type\_two\_facts                                                                              & 70                                                  & 1.21\%                                                                          & 8.57\%                                                                                                     & 0.00\%                                                                                 & 8.57\%                                  \\ \hline
    9                            & select\_object\_instance\_of\_type                                                                                     & 392                                                 & 6.79\%                                                                          & 4.34\%                                                                                                     & 6.12\%                                                                                 & \textbf{-1.78\%}                        \\ \hline
    10                           & select\_object\_using\_one\_statement\_property                                                                        & 583                                                 & 10.10\%                                                                         & 19.55\%                                                                                                    & 0.17\%                                                                                 & 19.38\%                                 \\ \hline
    11                           & select\_one\_fact\_object                                                                                              & 78                                                  & 1.35\%                                                                          & 7.69\%                                                                                                     & 1.28\%                                                                                 & 6.41\%                                  \\ \hline
    12                           & select\_one\_fact\_subject                                                                                             & 288                                                 & 4.99\%                                                                          & 3.82\%                                                                                                     & 4.17\%                                                                                 & \textbf{-0.35\%}                        \\ \hline
    13                           & \begin{tabular}[c]{@{}c@{}}select\_one\_qualifier\_value\_and\_object\_using\_one\\ \_statement\_property\end{tabular} & 136                                                 & 2.36\%                                                                          & 47.06\%                                                                                                    & 17.65\%                                                                                & 29.41\%                                 \\ \hline
    14                           & \begin{tabular}[c]{@{}c@{}}select\_one\_qualifier\_value\_using\_one\\ \_statement\_property\end{tabular}              & 631                                                 & 10.93\%                                                                         & 20.29\%                                                                                                    & 0.16\%                                                                                 & 20.13\%                                 \\ \hline
    15                           & select\_subject\_instance\_of\_type                                                                                    & 424                                                 & 7.35\%                                                                          & 5.42\%                                                                                                     & 7.31\%                                                                                 & \textbf{-1.89\%}                        \\ \hline
    16                           & select\_subject\_instance\_of\_type\_contains\_word                                                                    & 286                                                 & 4.95\%                                                                          & 13.64\%                                                                                                    & 2.10\%                                                                                 & 11.54\%                                 \\ \hline
    17                           & select\_subject\_instance\_of\_type\_starts\_with                                                                      & 285                                                 & 4.94\%                                                                          & 14.04\%                                                                                                    & 16.84\%                                                                                & \textbf{-2.80\%}                        \\ \hline
    18                           & select\_two\_answers                                                                                                   & 191                                                 & 3.31\%                                                                          & 14.14\%                                                                                                    & 3.66\%                                                                                 & 10.48\%                                 \\ \hline
    19                           & select\_two\_facts\_left\_subject                                                                                      & 393                                                 & 6.81\%                                                                          & 8.91\%                                                                                                     & 0.00\%                                                                                 & 8.91\%                                  \\ \hline
    20                           & select\_two\_facts\_right\_subject                                                                                     & 412                                                 & 7.14\%                                                                          & 9.95\%                                                                                                     & 0.00\%                                                                                 & 9.95\%                                  \\ \hline
    21                           & select\_two\_facts\_subject\_object                                                                                    & 389                                                 & 6.74\%                                                                          & 14.14\%                                                                                                    & 0.00\%                                                                                 & 14.14\%                                 \\ \hline
    22                           & \begin{tabular}[c]{@{}c@{}}select\_two\_qualifier\_values\_using\_one\\ \_statement\_property\end{tabular}             & 173                                                 & 3.00\%                                                                          & 8.67\%                                                                                                     & 2.31\%                                                                                 & 6.36\%                                  \\ \hline
    \multicolumn{2}{|c|}{\textbf{Total}}                                                                                                                  & 5772                                                & 100\%                                                                           & 13.96\%                                                                                                    & 3.27\%                                                                                 & 10.69\%                                 \\ \hline
    \end{tabular}%
    }
    \caption{Performance comparison per template for the SPARQL Query generation task.}
    \label{table:queryGenerationComparison}
\end{table}

The proposed system manages to achieve better accuracy in most cases. The cases that present the best 
results are the ASK queries with one query triple (\texttt{ask\_one\_fact}) and the SELECT queries 
that utilize one property statement and one qualifier property (\texttt{select\_one\_
qualifier\_value\_and\_object\_using\_one\_statement\_property}), which both require only one entity. One 
noticeable case where our system does not present a good performance is the rank type query that 
requires two query triples, where no query was successfully generated. As opposed to the best 
performing cases, these rank queries were among the most complex cases since they require 2 
entities and 3 properties to be correctly predicted; thus a single error would make the entire 
query incorrect.

Finally, in order to identify the most common sources of errors, we divided the results depending 
on the correct/incorrect answers expected for each module (Query Template generator, Entity Linking, 
Slot Filling). A comparison between our proposal (using the best performing settings) and the 
baseline is presented in Table~\ref{table:queryGenerationErrorRatio}. For each case, a circle 
means the system performed correctly and a cross is the opposite. For the Query Template 
generation task, a correct case is measured using the string-match accuracy. For Entity Linking 
we use recall, meaning that we count a case as correct if it identifies at least all expected 
entities, regardless of its precision (understanding that this is the minimum requirement to 
build a valid SPARQL query). For Slot Filling we consider it correct if all slot--entity pairs 
are correctly identified. Note that a correct SPARQL can only be generated if these three items 
deliver a correct answer.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
\begin{table}[h!]
    \centering
    \begin{tabular}{|ccc|cc|cc|}
    \hline
    \multicolumn{1}{|c|}{\multirow{2}{*}{\textbf{Template}}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{Entities}}} & \multirow{2}{*}{\textbf{Slots}} & \multicolumn{2}{c|}{\textbf{ElNeuQA}}                                                                                                                     & \multicolumn{2}{c|}{\textbf{Baseline}}                                                                                                                    \\ \cline{4-7} 
    \multicolumn{1}{|c|}{}                                   & \multicolumn{1}{c|}{}                                   &                                 & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Number \\ of cases\end{tabular}}} & \textbf{\begin{tabular}[c]{@{}c@{}}Dataset \\ \%\end{tabular}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Number \\ of cases\end{tabular}}} & \textbf{\begin{tabular}[c]{@{}c@{}}Dataset \\ \%\end{tabular}} \\ \hline
    O                                                        & O                                                       & O                               & 806                                                                                      & 13.96\%                                                        & 189                                                                                      & 3.27\%                                                         \\ \hline
    O                                                        & O                                                       & X                               & 229                                                                                      & 3.97\%                                                         & 74                                                                                       & 1.28\%                                                         \\ \hline
    O                                                        & X                                                       & O                               & 0                                                                                        & 0.00\%                                                         & 0                                                                                        & 0.00\%                                                         \\ \hline
    O                                                        & X                                                       & X                               & 777                                                                                      & 13.46\%                                                        & 1458                                                                                     & 25.26\%                                                        \\ \hline
    X                                                        & O                                                       & O                               & 903                                                                                      & 15.64\%                                                        & 158                                                                                      & 2.74\%                                                         \\ \hline
    X                                                        & O                                                       & X                               & 1415                                                                                     & 24.51\%                                                        & 149                                                                                      & 2.58\%                                                         \\ \hline
    X                                                        & X                                                       & O                               & 0                                                                                        & 0.00\%                                                         & 0                                                                                        & 0.00\%                                                         \\ \hline
    X                                                        & X                                                       & X                               & 1642                                                                                     & 28.45\%                                                        & 3744                                                                                     & 64.86\%                                                        \\ \hline
    \multicolumn{3}{|c|}{\textbf{Total}}                                                                                                                 & 5772                                                                                     & 100.00\%                                                       & 5772                                                                                     & 100.00\%                                                       \\ \hline
    \end{tabular}
    \caption{SPARQL query generation comparison results with baseline divided by error cases.}
    \label{table:queryGenerationErrorRatio}
\end{table}

The first thing to note is that the performance of the Slot Filling system is strongly impacted 
by the results delivered by the Entity Linking system. This is because there is no case where the 
slots were correctly identified while the entities were not. Next, we notice that if both 
template and entities are correctly identified, the Slot Filling system has an overall positive 
performance with a roughly 83\% accuracy. The error delivered for the Query Template generation 
was similar for both our system and the baseline, with 68.6\% and 70.2\% respectively.

Finally, the most noticeable comparison between both systems comes from a major difference in 
terms of vocabulary dependency. While only 47.6\% of the incorrect cases were caused by entity 
recognition error for our system, in the Baseline almost 94\% of the incorrect cases were caused 
due to not identifying all relevant entities.

\section{Question Answering over Knowledge Graphs}
\label{cap5:results/questionAnsweringKG}
We evaluate the results of the SPARQL queries output by our QA system proposal (using the best 
settings in terms of SPARQL Query generation performance) over Wikidata, and compare those results 
with the proposed Baseline. We show in Table~\ref{table:qakgMacroResults} the results for both 
systems on  the QAKG task. We chose to display only the macro measures given the difference of answer 
sizes for each case, where we wanted to weigh each case equally. Here we noticed that even though 
neither our proposal nor the baseline were capable of generating the expected SPARQL queries for 
the test datasets, some generated SPARQL queries were capable of obtaining answers among the 
expected results. 

We also evaluate the performance if we look over the best 5 predictions per 
case, where a general improvement is noticed along all datasets. In this case, the best prediction 
is the first query that returns a non-empty answer when being executed in the Wikidata endpoint. 
Note that this approach is not effective with ASK type questions, since there is always a 
non-empty answer (True or False).

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|c|ccc|ccc|ccc|}
    \hline
    \multirow{3}{*}{\textbf{System}} & \multicolumn{3}{c|}{\textbf{LC-QuAD 2 (valid)}}                                              & \multicolumn{3}{c|}{\textbf{QALD-7}}                                                         & \multicolumn{3}{c|}{\textbf{WikiSPARQL}}                                                     \\ \cline{2-10} 
                                     & \multicolumn{3}{c|}{\textbf{Size: 5772}}                                                     & \multicolumn{3}{c|}{\textbf{Size: 150}}                                                      & \multicolumn{3}{c|}{\textbf{Size: 100}}                                                      \\ \cline{2-10} 
                                     & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1} & \multicolumn{1}{c|}{\textbf{Recall}} & \multicolumn{1}{c|}{\textbf{Precision}} & \textbf{F1} \\ \hline
    ElNeuQA - Top 1                  & 27.0                                 & 26.9                                    & 26.9        & 9.3                                  & 9.3                                     & 9.3         & 12.9                                 & 12.9                                    & 12.9        \\
    ElNeuQA - Top 5                  & 30.0                                 & 29.6                                    & 29.6        & 12.7                                 & 12.7                                    & 12.7        & 11.9                                 & 11.9                                    & 11.9        \\ \hline
    Baseline                         & 16.6                                 & 16.4                                    & 16.4        & 7.3                                  & 7.3                                     & 7.3         & 6.0                                  & 5.5                                     & 5.3         \\ \hline
    \end{tabular}
    }
    \caption{Macro measure results for the Question Answering task.}
    \label{table:qakgMacroResults}
\end{table}

\newpage

Finally, an analysis over the different \LCQuADtwo{} templates is presented in Table~\ref{table:qakgMacroF1Diff}. 
We noticed that our proposal does better in almost every case compared with the baseline. The 
cases with the best performance include templates like \texttt{ASK} queries, \texttt{SELECT} 
queries that include property statements and qualifiers. 

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{table}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{|l|c|cc|cc|c|}
    \hline
    \multicolumn{7}{|c|}{\textbf{Performance analysis per template (ElNeuQA vs Baseline) - LC-QuAD 2 valid}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \\ \hline
    \multirow{2}{*}{\textbf{ID}} & \multirow{2}{*}{\textbf{Template type}}                                                                                & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{Size}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}\% \\ Dataset\end{tabular}}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}ElNeuQA \\ Macro F1\end{tabular}}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Baseline \\ Macro F1\end{tabular}}} & \multirow{2}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}Diff \\ Macro F1\end{tabular}}} \\
                                 &                                                                                                                        & \multicolumn{1}{c|}{}                               &                                                                                 & \multicolumn{1}{c|}{}                                                                                      &                                                                                        &                                                                                    \\ \hline
    1                            & ask\_one\_fact                                                                                                         & 112                                                 & 1.94\%                                                                          & 54.46                                                                                                      & 16.07                                                                                  & 38.39                                                                              \\ \hline
    2                            & ask\_one\_fact\_with\_filter                                                                                           & 362                                                 & 6.27\%                                                                          & 45.86                                                                                                      & 34.25                                                                                  & 11.60                                                                              \\ \hline
    3                            & ask\_two\_facts                                                                                                        & 113                                                 & 1.96\%                                                                          & 60.18                                                                                                      & 30.97                                                                                  & 29.20                                                                              \\ \hline
    4                            & count\_one\_fact\_object                                                                                               & 126                                                 & 2.18\%                                                                          & 21.43                                                                                                      & 11.11                                                                                  & 10.32                                                                              \\ \hline
    5                            & count\_one\_fact\_subject                                                                                              & 182                                                 & 3.15\%                                                                          & 10.44                                                                                                      & 2.20                                                                                   & 8.24                                                                               \\ \hline
    6                            & rank\_instance\_of\_type\_one\_fact                                                                                    & 78                                                  & 1.35\%                                                                          & 18.72                                                                                                      & 31.79                                                                                  & \textbf{-13.08}                                                                    \\ \hline
    7                            & rank\_max\_instance\_of\_type\_two\_facts                                                                              & 68                                                  & 1.18\%                                                                          & 30.98                                                                                                      & 25.29                                                                                  & 5.69                                                                               \\ \hline
    8                            & rank\_min\_instance\_of\_type\_two\_facts                                                                              & 70                                                  & 1.21\%                                                                          & 31.43                                                                                                      & 23.43                                                                                  & 8.00                                                                               \\ \hline
    9                            & select\_object\_instance\_of\_type                                                                                     & 392                                                 & 6.79\%                                                                          & 16.07                                                                                                      & 20.38                                                                                  & \textbf{-4.32}                                                                     \\ \hline
    10                           & select\_object\_using\_one\_statement\_property                                                                        & 583                                                 & 10.10\%                                                                         & 33.28                                                                                                      & 14.82                                                                                  & 18.46                                                                              \\ \hline
    11                           & select\_one\_fact\_object                                                                                              & 78                                                  & 1.35\%                                                                          & 14.10                                                                                                      & 6.41                                                                                   & 7.69                                                                               \\ \hline
    12                           & select\_one\_fact\_subject                                                                                             & 288                                                 & 4.99\%                                                                          & 11.79                                                                                                      & 12.15                                                                                  & \textbf{-0.36}                                                                     \\ \hline
    13                           & \begin{tabular}[c]{@{}c@{}}select\_one\_qualifier\_value\_and\_object\_using\_one\\ \_statement\_property\end{tabular} & 136                                                 & 2.36\%                                                                          & 48.61                                                                                                      & 20.11                                                                                  & 28.50                                                                              \\ \hline
    14                           & \begin{tabular}[c]{@{}c@{}}select\_one\_qualifier\_value\_using\_one\\ \_statement\_property\end{tabular}              & 631                                                 & 10.93\%                                                                         & 31.41                                                                                                      & 11.89                                                                                  & 19.52                                                                              \\ \hline
    15                           & select\_subject\_instance\_of\_type                                                                                    & 424                                                 & 7.35\%                                                                          & 17.30                                                                                                      & 19.87                                                                                  & \textbf{-2.57}                                                                     \\ \hline
    16                           & select\_subject\_instance\_of\_type\_contains\_word                                                                    & 286                                                 & 4.95\%                                                                          & 27.19                                                                                                      & 16.41                                                                                  & 10.79                                                                              \\ \hline
    17                           & select\_subject\_instance\_of\_type\_starts\_with                                                                      & 285                                                 & 4.94\%                                                                          & 29.99                                                                                                      & 26.34                                                                                  & 3.65                                                                               \\ \hline
    18                           & select\_two\_answers                                                                                                   & 191                                                 & 3.31\%                                                                          & 22.43                                                                                                      & 7.33                                                                                   & 15.10                                                                              \\ \hline
    19                           & select\_two\_facts\_left\_subject                                                                                      & 393                                                 & 6.81\%                                                                          & 17.02                                                                                                      & 9.03                                                                                   & 7.99                                                                               \\ \hline
    20                           & select\_two\_facts\_right\_subject                                                                                     & 412                                                 & 7.14\%                                                                          & 20.54                                                                                                      & 10.84                                                                                  & 9.70                                                                               \\ \hline
    21                           & select\_two\_facts\_subject\_object                                                                                    & 389                                                 & 6.74\%                                                                          & 28.02                                                                                                      & 14.91                                                                                  & 13.11                                                                              \\ \hline
    22                           & \begin{tabular}[c]{@{}c@{}}select\_two\_qualifier\_values\_using\_one\\ \_statement\_property\end{tabular}             & 173                                                 & 3.00\%                                                                          & 26.59                                                                                                      & 16.18                                                                                  & 10.40                                                                              \\ \hline
    \multicolumn{2}{|c|}{\textbf{Total}}                                                                                                                  & 5772                                                & 100\%                                                                           & 26.90                                                                                                      & 16.40                                                                                  & 10.50                                                                              \\ \hline
    \end{tabular}%
    }
    \caption{Performance comparison per template for the Question Answering task.}
    \label{table:qakgMacroF1Diff}
    \end{table}

Another thing to notice is that there is no clear correlation between the performance and the amount 
of cases per template, meaning that a greater amount of cases for one template to use in the training 
stage does not necessarily come with an increase in performance. A clear example are the \texttt{COUNT} 
queries: while the \texttt{count\_one\_fact\_object} template has fewer examples than the 
\texttt{count\_one\_fact\_subject}, but our system performs worse with the latter template. 

Lastly, the complexity of each template does not necessarily predict the performance of the Question 
Answering system in terms of Macro F1. Queries derived from complex templates such as the 
\texttt{rank\_max\_instance\_of\_type\_two\_facts} template present better performance than simpler 
templates such as the \texttt{select\_subject\_instance\_of\_type} template. There might be other 
variables that affect performance per template that we are not considering here. For example, there 
might be entities or properties used for each template that can be more complex to identify or are 
not very common, thus making it more difficult to predict those cases.
